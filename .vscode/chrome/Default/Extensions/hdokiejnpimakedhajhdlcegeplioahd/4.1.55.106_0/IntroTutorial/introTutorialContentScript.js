!function(t){"use strict";var o=function(o){bg.IntroTutorial.getState(function(e){if(e.enabled&&document.location.host.toLowerCase().includes(e.domain)){var i=e.isInContext?t.InContextIntroTutorialDialogOptions:t.VaultIntroTutorialDialogOptions;o(e,i)}})};Topics.get(Topics.SITE_NOTIFICATION_STATE).subscribe(function(t){function e(t){n&&t&&LPFrame.css({id:n.getDialogID(),css:{top:t.top+40,left:t.left+380}})}function i(t){n?(Topics.get(Topics.INFIELD_FRAME_POSITION_CHANGED).unsubscribe(e),bg.IntroTutorial.getState(function(o){"add_first_site"!==o.inContextOnboardingStep&&(n.close(!0),n=null,t&&t())})):t&&t()}var n=null;o(function(t,o){var e=LPSiteService.getSite(t.domain);if(e.isLoggedIn(document)){if(bg.IntroTutorial.setState({firstLogin:!1}),!LPFrame.hasDialogs()&&(n=t.isLoginTheLastPassWay?LPFrame.openDialog(o.name,{addHide:!0,textChoice:"loginTheLastPassWay",arrow:o.getArrowOptions()},{css:o.getCssOptions()}):LPFrame.openDialog(o.name,{addHide:!0,textChoice:"siteLanding",arrow:o.getArrowOptions()},{css:o.getCssOptions()}))){var i=o.getTrackElementOptions();i.element=e.getTrackingEl(document),n.trackElement(i)}}else t.firstLogin?e.logMeOut(document,o.name):t.isAllSet&&bg.IntroTutorial.completeTutorial({textChoice:"completed"})}),Topics.get(Topics.SITE_NOTIFICATION).subscribe(function(e){o(function(o,i){bg.IntroTutorial.setState({inContextOnboardingStep:"add_site_to_lastpass"}),setTimeout(function(){bg.sendLpImprove("onboardingtour::displayed_onboarding_save_a_site",{version:"incontext"}),e.getInterface().LPDialog.openDialog(i.name,{addHide:!0,siteName:t.defaultData.name,textChoice:"saveSite",parentDialog:"contentScriptSite",css:{position:"absolute",top:"100%","margin-top":"10px","margin-right":0,right:0},arrow:{orientation:"top",positionTarget:"#submit"}})},1e3)})}),Topics.get(Topics.INFIELD_NOTIFICATION_OPENED).subscribe(function(t){o(function(o,s){i(function(){var i=o.inContextOnboardingStep;i&&"add_first_site"!==i&&(n=LPFrame.openDialog(s.name,{addHide:!0,textChoice:"selectYourSite",arrow:s.getArrowOptions()},{css:{width:"auto",height:"auto","min-width":"168px"}})),Topics.get(Topics.INFIELD_FRAME_POSITION_CHANGED).subscribe(e),e(t)})})}),Topics.get(Topics.INFIELD_NOTIFICATION_FILLED).subscribe(function(){o(function(t,o){t.enabled&&(bg.IntroTutorial.setState({isLoginTheLastPassWay:!1}),bg.IntroTutorial.completeTutorial({textChoice:"completed",siteName:t.domain}))})}),Topics.get(Topics.INFIELD_NOTIFICATION_CLOSED).subscribe(function(){o(function(t,o){i()})})})}(IntroTutorialDialogOptions);